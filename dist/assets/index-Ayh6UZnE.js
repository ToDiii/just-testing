var we=Object.defineProperty;var ke=(t,e,n)=>e in t?we(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Q=(t,e,n)=>ke(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))l(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&l(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function l(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function A(){}function pe(t){return t()}function re(){return Object.create(null)}function P(t){t.forEach(pe)}function he(t){return typeof t=="function"}function Z(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function ve(t){return Object.keys(t).length===0}function u(t,e){t.appendChild(e)}function O(t,e,n){t.insertBefore(e,n||null)}function N(t){t.parentNode&&t.parentNode.removeChild(t)}function _(t){return document.createElement(t)}function j(t){return document.createTextNode(t)}function C(){return j(" ")}function D(t,e,n,l){return t.addEventListener(e,n,l),()=>t.removeEventListener(e,n,l)}function $e(t){return function(e){return e.preventDefault(),t.call(this,e)}}function h(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Se(t){return Array.from(t.childNodes)}function R(t,e){e=""+e,t.data!==e&&(t.data=e)}function q(t,e){t.value=e??""}let H;function z(t){H=t}function Ee(){if(!H)throw new Error("Function called outside component initialization");return H}function _e(t){Ee().$$.on_mount.push(t)}const I=[],se=[];let B=[];const ie=[],Le=Promise.resolve();let X=!1;function Te(){X||(X=!0,Le.then(me))}function Y(t){B.push(t)}const W=new Set;let F=0;function me(){if(F!==0)return;const t=H;do{try{for(;F<I.length;){const e=I[F];F++,z(e),Ce(e.$$)}}catch(e){throw I.length=0,F=0,e}for(z(null),I.length=0,F=0;se.length;)se.pop()();for(let e=0;e<B.length;e+=1){const n=B[e];W.has(n)||(W.add(n),n())}B.length=0}while(I.length);for(;ie.length;)ie.pop()();X=!1,W.clear(),z(t)}function Ce(t){if(t.fragment!==null){t.update(),P(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Y)}}function xe(t){const e=[],n=[];B.forEach(l=>t.indexOf(l)===-1?e.push(l):n.push(l)),n.forEach(l=>l()),B=e}const J=new Set;let U;function Ne(){U={r:0,c:[],p:U}}function Me(){U.r||P(U.c),U=U.p}function V(t,e){t&&t.i&&(J.delete(t),t.i(e))}function K(t,e,n,l){if(t&&t.o){if(J.has(t))return;J.add(t),U.c.push(()=>{J.delete(t),l&&(n&&t.d(1),l())}),t.o(e)}else l&&l()}function G(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function ge(t,e){t.d(1),e.delete(t.key)}function be(t,e,n,l,r,s,o,c,a,i,m,f){let d=t.length,b=s.length,S=d;const L={};for(;S--;)L[t[S].key]=S;const y=[],g=new Map,T=new Map,x=[];for(S=b;S--;){const $=f(r,s,S),w=n($);let k=o.get(w);k?x.push(()=>k.p($,e)):(k=i(w,$),k.c()),g.set(w,y[S]=k),w in L&&T.set(w,Math.abs(S-L[w]))}const E=new Set,p=new Set;function v($){V($,1),$.m(c,m),o.set($.key,$),m=$.first,b--}for(;d&&b;){const $=y[b-1],w=t[d-1],k=$.key,M=w.key;$===w?(m=$.first,d--,b--):g.has(M)?!o.has(k)||E.has(k)?v($):p.has(M)?d--:T.get(k)>T.get(M)?(p.add(k),v($)):(E.add(M),d--):(a(w,o),d--)}for(;d--;){const $=t[d];g.has($.key)||a($,o)}for(;b;)v(y[b-1]);return P(x),y}function ye(t){t&&t.c()}function ee(t,e,n){const{fragment:l,after_update:r}=t.$$;l&&l.m(e,n),Y(()=>{const s=t.$$.on_mount.map(pe).filter(he);t.$$.on_destroy?t.$$.on_destroy.push(...s):P(s),t.$$.on_mount=[]}),r.forEach(Y)}function te(t,e){const n=t.$$;n.fragment!==null&&(xe(n.after_update),P(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Oe(t,e){t.$$.dirty[0]===-1&&(I.push(t),Te(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ne(t,e,n,l,r,s,o=null,c=[-1]){const a=H;z(t);const i=t.$$={fragment:null,ctx:[],props:s,update:A,not_equal:r,bound:re(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:re(),dirty:c,skip_bound:!1,root:e.target||a.$$.root};o&&o(i.root);let m=!1;if(i.ctx=n?n(t,e.props||{},(f,d,...b)=>{const S=b.length?b[0]:d;return i.ctx&&r(i.ctx[f],i.ctx[f]=S)&&(!i.skip_bound&&i.bound[f]&&i.bound[f](S),m&&Oe(t,f)),d}):[],i.update(),m=!0,P(i.before_update),i.fragment=l?l(i.ctx):!1,e.target){if(e.hydrate){const f=Se(e.target);i.fragment&&i.fragment.l(f),f.forEach(N)}else i.fragment&&i.fragment.c();e.intro&&V(t.$$.fragment),ee(t,e.target,e.anchor),me()}z(a)}class le{constructor(){Q(this,"$$");Q(this,"$$set")}$destroy(){te(this,1),this.$destroy=A}$on(e,n){if(!he(n))return A;const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(n),()=>{const r=l.indexOf(n);r!==-1&&l.splice(r,1)}}$set(e){this.$$set&&!ve(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const je="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(je);function oe(t,e,n){const l=t.slice();return l[9]=e[n],l}function ue(t){let e,n;return{c(){e=_("p"),n=j(t[4]),h(e,"class","text-red-500 mt-2")},m(l,r){O(l,e,r),u(e,n)},p(l,r){r&16&&R(n,l[4])},d(l){l&&N(e)}}}function Ae(t){let e,n=[],l=new Map,r=G(t[0]);const s=o=>o[9].id;for(let o=0;o<r.length;o+=1){let c=oe(t,r,o),a=s(c);l.set(a,n[o]=ce(a,c))}return{c(){e=_("ul");for(let o=0;o<n.length;o+=1)n[o].c();h(e,"class","space-y-2")},m(o,c){O(o,e,c);for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(e,null)},p(o,c){c&1&&(r=G(o[0]),n=be(n,c,s,1,o,r,l,e,ge,ce,null,oe))},d(o){o&&N(e);for(let c=0;c<n.length;c+=1)n[c].d()}}}function Pe(t){let e;return{c(){e=_("p"),e.textContent="No targets configured yet."},m(n,l){O(n,e,l)},p:A,d(n){n&&N(e)}}}function Re(t){let e;return{c(){e=_("p"),e.textContent="Loading targets..."},m(n,l){O(n,e,l)},p:A,d(n){n&&N(e)}}}function ce(t,e){let n,l,r=(e[9].name||"Unnamed")+"",s,o,c,a=e[9].url+"",i,m;return{key:t,first:null,c(){n=_("li"),l=_("p"),s=j(r),o=C(),c=_("p"),i=j(a),m=C(),h(l,"class","font-bold text-gray-800"),h(c,"class","text-sm text-gray-600"),h(n,"class","p-4 bg-gray-50 rounded-md border border-gray-200"),this.first=n},m(f,d){O(f,n,d),u(n,l),u(l,s),u(n,o),u(n,c),u(c,i),u(n,m)},p(f,d){e=f,d&1&&r!==(r=(e[9].name||"Unnamed")+"")&&R(s,r),d&1&&a!==(a=e[9].url+"")&&R(i,a)},d(f){f&&N(n)}}}function De(t){let e,n,l,r,s,o,c,a,i,m,f,d,b,S,L,y,g,T,x,E,p=t[4]&&ue(t);function v(k,M){return k[3]?Re:k[0].length===0?Pe:Ae}let $=v(t),w=$(t);return{c(){e=_("div"),n=_("h2"),n.textContent="Manage Targets",l=C(),r=_("div"),s=_("h3"),s.textContent="Add New Target",o=C(),c=_("form"),a=_("div"),i=_("input"),m=C(),f=_("input"),d=C(),b=_("button"),b.textContent="Add Target",S=C(),p&&p.c(),L=C(),y=_("div"),g=_("h3"),g.textContent="Existing Targets",T=C(),w.c(),h(n,"class","text-2xl font-bold mb-4"),h(s,"class","text-xl font-semibold mb-2"),h(i,"type","text"),h(i,"placeholder","Name (e.g., City Name)"),h(i,"class","input input-bordered w-full"),h(f,"type","url"),h(f,"placeholder","URL"),f.required=!0,h(f,"class","input input-bordered w-full"),h(a,"class","flex flex-col md:flex-row gap-4 mb-2"),h(b,"type","submit"),h(b,"class","btn btn-primary"),h(r,"class","mb-6"),h(g,"class","text-xl font-semibold mb-2"),h(e,"class","bg-white p-6 rounded-lg shadow-md")},m(k,M){O(k,e,M),u(e,n),u(e,l),u(e,r),u(r,s),u(r,o),u(r,c),u(c,a),u(a,i),q(i,t[1]),u(a,m),u(a,f),q(f,t[2]),u(c,d),u(c,b),u(r,S),p&&p.m(r,null),u(e,L),u(e,y),u(y,g),u(y,T),w.m(y,null),x||(E=[D(i,"input",t[6]),D(f,"input",t[7]),D(c,"submit",$e(t[5]))],x=!0)},p(k,[M]){M&2&&i.value!==k[1]&&q(i,k[1]),M&4&&f.value!==k[2]&&q(f,k[2]),k[4]?p?p.p(k,M):(p=ue(k),p.c(),p.m(r,null)):p&&(p.d(1),p=null),$===($=v(k))&&w?w.p(k,M):(w.d(1),w=$(k),w&&(w.c(),w.m(y,null)))},i:A,o:A,d(k){k&&N(e),p&&p.d(),w.d(),x=!1,P(E)}}}function Ue(t,e,n){let l=[],r="",s="",o=!0,c="";async function a(){n(3,o=!0),n(4,c="");try{const d=await fetch("/api/targets/");if(!d.ok)throw new Error("Failed to fetch targets.");n(0,l=await d.json())}catch(d){n(4,c=d.message)}finally{n(3,o=!1)}}async function i(){if(!s){n(4,c="URL is required.");return}try{const d=await fetch("/api/targets/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:r,url:s})});if(!d.ok){const b=await d.json();throw new Error(b.detail||"Failed to add target.")}n(1,r=""),n(2,s=""),a()}catch(d){n(4,c=d.message)}}_e(a);function m(){r=this.value,n(1,r)}function f(){s=this.value,n(2,s)}return[l,r,s,o,c,i,m,f]}class Fe extends le{constructor(e){super(),ne(this,e,Ue,De,Z,{})}}function ae(t,e,n){const l=t.slice();return l[9]=e[n],l}function Ie(t){let e;return{c(){e=j("Run Scrape")},m(n,l){O(n,e,l)},d(n){n&&N(e)}}}function qe(t){let e,n;return{c(){e=_("span"),n=j(`
        Scraping...`),h(e,"class","loading loading-spinner")},m(l,r){O(l,e,r),O(l,n,r)},d(l){l&&(N(e),N(n))}}}function fe(t){let e,n;return{c(){e=_("p"),n=j(t[3]),h(e,"class","text-red-500 my-2")},m(l,r){O(l,e,r),u(e,n)},p(l,r){r&8&&R(n,l[3])},d(l){l&&N(e)}}}function Be(t){let e,n,l,r,s=[],o=new Map,c=G(t[0]);const a=i=>i[9].id;for(let i=0;i<c.length;i+=1){let m=ae(t,c,i),f=a(m);o.set(f,s[i]=de(f,m))}return{c(){e=_("table"),n=_("thead"),n.innerHTML="<tr><th>Title</th> <th>Source</th> <th>Publication Date</th> <th>Scraped At</th></tr>",l=C(),r=_("tbody");for(let i=0;i<s.length;i+=1)s[i].c();h(e,"class","table w-full")},m(i,m){O(i,e,m),u(e,n),u(e,l),u(e,r);for(let f=0;f<s.length;f+=1)s[f]&&s[f].m(r,null)},p(i,m){m&1&&(c=G(i[0]),s=be(s,m,a,1,i,c,o,r,ge,de,null,ae))},d(i){i&&N(e);for(let m=0;m<s.length;m+=1)s[m].d()}}}function Ve(t){let e;return{c(){e=_("p"),e.textContent="No results found. Try running a scrape."},m(n,l){O(n,e,l)},p:A,d(n){n&&N(e)}}}function ze(t){let e;return{c(){e=_("p"),e.textContent="Loading results..."},m(n,l){O(n,e,l)},p:A,d(n){n&&N(e)}}}function de(t,e){let n,l,r,s=e[9].title+"",o,c,a,i,m=e[9].source+"",f,d,b,S=e[9].publication_date+"",L,y,g,T=new Date(e[9].scraped_at).toLocaleString()+"",x,E;return{key:t,first:null,c(){n=_("tr"),l=_("td"),r=_("a"),o=j(s),a=C(),i=_("td"),f=j(m),d=C(),b=_("td"),L=j(S),y=C(),g=_("td"),x=j(T),E=C(),h(r,"href",c=e[9].url),h(r,"target","_blank"),h(r,"class","link link-primary"),h(n,"class","hover"),this.first=n},m(p,v){O(p,n,v),u(n,l),u(l,r),u(r,o),u(n,a),u(n,i),u(i,f),u(n,d),u(n,b),u(b,L),u(n,y),u(n,g),u(g,x),u(n,E)},p(p,v){e=p,v&1&&s!==(s=e[9].title+"")&&R(o,s),v&1&&c!==(c=e[9].url)&&h(r,"href",c),v&1&&m!==(m=e[9].source+"")&&R(f,m),v&1&&S!==(S=e[9].publication_date+"")&&R(L,S),v&1&&T!==(T=new Date(e[9].scraped_at).toLocaleString()+"")&&R(x,T)},d(p){p&&N(n)}}}function He(t){let e,n,l,r,s,o,c,a,i,m,f,d,b;function S(p,v){return p[2]?qe:Ie}let L=S(t),y=L(t),g=t[3]&&fe(t);function T(p,v){return p[1]?ze:p[0].length===0?Ve:Be}let x=T(t),E=x(t);return{c(){e=_("div"),n=_("div"),l=_("h2"),l.textContent="Scrape Results",r=C(),s=_("button"),y.c(),o=C(),c=_("div"),a=_("input"),i=C(),g&&g.c(),m=C(),f=_("div"),E.c(),h(l,"class","text-2xl font-bold"),h(s,"class","btn btn-primary"),s.disabled=t[2],h(n,"class","flex justify-between items-center mb-4"),h(a,"type","text"),h(a,"placeholder","Filter by keyword..."),h(a,"class","input input-bordered w-full"),h(c,"class","mb-4"),h(f,"class","overflow-x-auto"),h(e,"class","bg-white p-6 rounded-lg shadow-md")},m(p,v){O(p,e,v),u(e,n),u(n,l),u(n,r),u(n,s),y.m(s,null),u(e,o),u(e,c),u(c,a),q(a,t[4]),u(e,i),g&&g.m(e,null),u(e,m),u(e,f),E.m(f,null),d||(b=[D(s,"click",t[6]),D(a,"input",t[7]),D(a,"input",t[8])],d=!0)},p(p,[v]){L!==(L=S(p))&&(y.d(1),y=L(p),y&&(y.c(),y.m(s,null))),v&4&&(s.disabled=p[2]),v&16&&a.value!==p[4]&&q(a,p[4]),p[3]?g?g.p(p,v):(g=fe(p),g.c(),g.m(e,m)):g&&(g.d(1),g=null),x===(x=T(p))&&E?E.p(p,v):(E.d(1),E=x(p),E&&(E.c(),E.m(f,null)))},i:A,o:A,d(p){p&&N(e),y.d(),g&&g.d(),E.d(),d=!1,P(b)}}}function Je(t,e,n){let l=[],r=!0,s=!1,o="",c="";async function a(){n(1,r=!0),n(3,o="");const d=new URLSearchParams;c&&d.append("search",c);try{const b=await fetch(`/api/results/?${d.toString()}`);if(!b.ok)throw new Error("Failed to fetch results.");n(0,l=await b.json())}catch(b){n(3,o=b.message)}finally{n(1,r=!1)}}async function i(){n(2,s=!0),n(3,o="");try{const d=await fetch("/api/scrape",{method:"POST"});if(!d.ok){const b=await d.json();throw new Error(b.detail||"Scraping failed.")}await a()}catch(d){n(3,o=d.message)}finally{n(2,s=!1)}}_e(a);function m(){c=this.value,n(4,c)}return[l,r,s,o,c,a,i,m,()=>a()]}class Ke extends le{constructor(e){super(),ne(this,e,Je,He,Z,{})}}function Ge(t){let e,n;return e=new Fe({}),{c(){ye(e.$$.fragment)},m(l,r){ee(e,l,r),n=!0},i(l){n||(V(e.$$.fragment,l),n=!0)},o(l){K(e.$$.fragment,l),n=!1},d(l){te(e,l)}}}function Qe(t){let e,n;return e=new Ke({}),{c(){ye(e.$$.fragment)},m(l,r){ee(e,l,r),n=!0},i(l){n||(V(e.$$.fragment,l),n=!0)},o(l){K(e.$$.fragment,l),n=!1},d(l){te(e,l)}}}function We(t){let e,n,l,r,s,o,c,a,i,m,f,d,b,S,L,y,g,T,x,E;const p=[Qe,Ge],v=[];function $(w,k){return w[0]==="results"?0:1}return y=$(t),g=v[y]=p[y](t),{c(){e=_("main"),n=_("header"),l=_("div"),r=_("h1"),r.textContent="Scraper Dashboard",s=C(),o=_("nav"),c=_("button"),a=j("Results"),m=C(),f=_("button"),d=j("Manage Targets"),S=C(),L=_("div"),g.c(),h(r,"class","text-3xl font-bold text-gray-800"),h(c,"class",i="px-4 py-2 rounded-md mr-2 "+(t[0]==="results"?"bg-blue-500 text-white":"bg-gray-200")),h(f,"class",b="px-4 py-2 rounded-md "+(t[0]==="targets"?"bg-blue-500 text-white":"bg-gray-200")),h(o,"class","mt-4"),h(l,"class","container mx-auto px-4 py-6"),h(n,"class","bg-white shadow"),h(L,"class","container mx-auto p-4 mt-6"),h(e,"class","bg-gray-100 min-h-screen font-sans")},m(w,k){O(w,e,k),u(e,n),u(n,l),u(l,r),u(l,s),u(l,o),u(o,c),u(c,a),u(o,m),u(o,f),u(f,d),u(e,S),u(e,L),v[y].m(L,null),T=!0,x||(E=[D(c,"click",t[1]),D(f,"click",t[2])],x=!0)},p(w,[k]){(!T||k&1&&i!==(i="px-4 py-2 rounded-md mr-2 "+(w[0]==="results"?"bg-blue-500 text-white":"bg-gray-200")))&&h(c,"class",i),(!T||k&1&&b!==(b="px-4 py-2 rounded-md "+(w[0]==="targets"?"bg-blue-500 text-white":"bg-gray-200")))&&h(f,"class",b);let M=y;y=$(w),y!==M&&(Ne(),K(v[M],1,1,()=>{v[M]=null}),Me(),g=v[y],g||(g=v[y]=p[y](w),g.c()),V(g,1),g.m(L,null))},i(w){T||(V(g),T=!0)},o(w){K(g),T=!1},d(w){w&&N(e),v[y].d(),x=!1,P(E)}}}function Xe(t,e,n){let l="results";return[l,()=>n(0,l="results"),()=>n(0,l="targets")]}class Ye extends le{constructor(e){super(),ne(this,e,Xe,We,Z,{})}}new Ye({target:document.getElementById("app")});
